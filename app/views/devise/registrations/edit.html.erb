<div class="min-h-screen bg-gradient-to-br from-orange-50 via-orange-100 to-yellow-50 py-8">
  <div class="max-w-2xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- 戻るリンク -->
    <div class="mb-6">
      <%= link_to "← 戻る", :back,
                  class: "text-orange-500 hover:text-orange-700 font-medium inline-flex items-center" %>
    </div>

    <!-- アカウント設定フォーム -->
    <div class="bg-white rounded-3xl shadow-2xl border border-orange-200 overflow-hidden">
      <div class="px-8 py-6 bg-gradient-to-r from-orange-400 to-orange-500">
        <h2 class="text-2xl font-bold text-white flex items-center">
          アカウント設定
        </h2>
        <p class="text-orange-100 text-sm mt-1">プロフィール情報やパスワードを変更できます</p>
      </div>

      <div class="p-8">
        <%= form_with model: resource, as: resource_name, url: registration_path(resource_name), method: :put, local: true, class: "space-y-6" do |f| %>
          <%= render "devise/shared/error_messages", resource: resource %>

          <!-- 表示名 -->
          <div>
            <%= f.label :display_name, class: "flex items-center text-sm font-medium text-orange-700 mb-2" do %>
              <%= icon_tag :user, class: "w-4 h-4 mr-2", alt: "ユーザー" %>
              表示名
            <% end %>
            <%= f.text_field :display_name,
                              autofocus: true,
                              class: "w-full px-4 py-3 border border-orange-200 rounded-lg focus:ring-2 focus:ring-orange-400 focus:border-orange-400 transition duration-200" %>
          </div>

          <!-- メールアドレス -->
          <div>
            <%= f.label :email, raw("#{icon_tag :mail, class: 'inline w-4 h-4 mr-1'} メールアドレス"), class: "block text-sm font-medium text-orange-700 mb-2" %>
            <%= f.email_field :email,
                               autocomplete: "email",
                               class: "w-full px-4 py-3 border border-orange-200 rounded-lg focus:ring-2 focus:ring-orange-400 focus:border-orange-400 transition duration-200" %>
            <% if devise_mapping.confirmable? && resource.pending_reconfirmation? %>
              <p class="text-sm text-orange-600 mt-1">確認待ち: <%= resource.unconfirmed_email %></p>
            <% end %>
          </div>

            <!-- 現在のパスワード -->
          <div>
            <%= f.label :current_password, raw("#{icon_tag :lock, class: 'inline w-4 h-4 mr-1'} 現在のパスワード"), class: "block text-sm font-medium text-orange-700 mb-2" %>
            <div class="relative" data-controller="password-toggle">
              <%= f.password_field :current_password,
                                   autocomplete: "current-password",
                                   class: "w-full px-4 py-3 pr-10 border border-orange-200 rounded-lg focus:ring-2 focus:ring-orange-400 focus:border-orange-400 transition duration-200",
                                   data: { password_toggle_target: "password" } %>
              <div class="absolute inset-y-0 right-0 pr-3 flex items-center">
                <%= image_tag "/icons/eye_show.svg", 
                            alt: "パスワード表示",
                            class: "text-orange-400 cursor-pointer w-5 h-5",
                            data: { 
                              password_toggle_target: "icon",
                              action: "click->password-toggle#toggle"
                            } %>
              </div>
            </div>
            <p class="text-xs text-gray-500 mt-1">変更を確認するため、現在のパスワードを入力してください</p>
          </div>

          <!-- パスワード -->
          <div>
            <%= f.label :password, raw("#{icon_tag :key, class: 'inline w-4 h-4 mr-1'} 新しいパスワード"), class: "block text-sm font-medium text-orange-700 mb-2" %>
            <div class="relative" data-controller="password-toggle">
              <%= f.password_field :password,
                                   autocomplete: "new-password",
                                   class: "w-full px-4 py-3 pr-10 border border-orange-200 rounded-lg focus:ring-2 focus:ring-orange-400 focus:border-orange-400 transition duration-200",
                                   data: { password_toggle_target: "password" } %>
              <div class="absolute inset-y-0 right-0 pr-3 flex items-center">
                <%= image_tag "/icons/eye_show.svg", 
                            alt: "パスワード表示",
                            class: "text-orange-400 cursor-pointer w-5 h-5",
                            data: { 
                              password_toggle_target: "icon",
                              action: "click->password-toggle#toggle"
                            } %>
              </div>
            </div>
            <p class="text-xs text-gray-500 mt-1">
              変更しない場合は空欄にしてください
              <% if @minimum_password_length %>
                （最低<%= @minimum_password_length %>文字）
              <% end %>
            </p>
          </div>

          <!-- パスワード確認 -->
          <div>
            <%= f.label :password_confirmation, raw("#{icon_tag :key, class: 'inline w-4 h-4 mr-1'} 新しいパスワード（確認）"), class: "block text-sm font-medium text-orange-700 mb-2" %>
            <div class="relative" data-controller="password-toggle">
              <%= f.password_field :password_confirmation,
                                   autocomplete: "new-password",
                                   class: "w-full px-4 py-3 pr-10 border border-orange-200 rounded-lg focus:ring-2 focus:ring-orange-400 focus:border-orange-400 transition duration-200",
                                   data: { password_toggle_target: "password" } %>
              <div class="absolute inset-y-0 right-0 pr-3 flex items-center">
                <%= image_tag "/icons/eye_show.svg", 
                            alt: "パスワード表示",
                            class: "text-orange-400 cursor-pointer w-5 h-5",
                            data: { 
                              password_toggle_target: "icon",
                              action: "click->password-toggle#toggle"
                            } %>
              </div>
            </div>
          </div>



          <!-- 更新ボタン -->
          <div class="pt-4">
            <%= f.submit "更新",
                         class: "w-full bg-orange-500 hover:bg-orange-600 text-white py-3 px-6 rounded-lg font-medium transition duration-200 shadow-lg" %>
          </div>
        <% end %>
      </div>
    </div>

    <!-- アカウント削除 -->
    <%# <div class="mt-8 bg-white rounded-2xl shadow-lg border border-red-200 overflow-hidden">
      <div class="px-6 py-4 bg-red-50 border-b border-red-200">
        <h3 class="text-lg font-semibold text-red-700 flex items-center">
          <%= icon_tag :alert, class: "mr-2 w-5 h-5 inline" %>危険な操作
        </h3>
      </div>
      <div class="p-6">
        <p class="text-gray-600 mb-4">
          アカウントを削除すると、すべての投稿とデータが永久に削除されます。この操作は取り消せません。
        </p>
        <%= button_to "アカウントを削除", registration_path(resource_name),
                      method: :delete,
                      data: {
                        confirm: "本当にアカウントを削除しますか？この操作は取り消せません。",
                        turbo_confirm: "本当にアカウントを削除しますか？この操作は取り消せません。"
                      },
                      class: "bg-red-500 hover:bg-red-600 text-white py-2 px-4 rounded-lg font-medium transition duration-200" %>
      <%# </div> %>
    <%# </div> %>
  </div>
</div>
